# Codebase Cleanup Plan

## Files to KEEP (Essential)

### Core Plugin Files
- ✅ `code.ts` - Main plugin logic with component data
- ✅ `code.js` - Built plugin (generated by build)
- ✅ `ui.html` - Plugin UI
- ✅ `manifest.json` - Plugin manifest (UPDATED: removed networkAccess)
- ✅ `package.json` - Dependencies
- ✅ `tsconfig.json` - TypeScript config

### Essential Scripts (For Future Updates)
- ✅ `convert-all-thumbnails.js` - Convert SVG thumbnails to base64
- ✅ `convert-preface-thumbnails.js` - Convert PNG thumbnails to base64
- ✅ `extract-components.js` - Extract component metadata from Figma API
- ✅ `verify-thumbnails.js` - Verify all thumbnails are embedded

### Documentation
- ✅ `README.md` - Project documentation
- ✅ `PUBLICATION_DETAILS.md` - Plugin description for Figma Community
- ✅ `ADDING_NEW_COMPONENTS.md` - Guide for adding components
- ✅ `RELOAD_PLUGIN.md` - How to reload plugin after changes
- ✅ `UPDATE_SUMMARY.md` - Latest update summary

### Data Files
- ✅ `components.json` - Cached component metadata
- ✅ `thumbnails/` - Source thumbnail files (SVG/PNG)

## Files to DELETE (Temporary/Obsolete)

### One-Time Use Scripts (Already Executed)
- ❌ `add-concepts-component.js` - Used once to add Concepts & Principles
- ❌ `add-concepts-principles.js` - Duplicate of above
- ❌ `add-new-components.js` - Used once to add Delay and File Stack
- ❌ `download-new-thumbnails.js` - One-time download script
- ❌ `update-component-key.js` - One-time key update script
- ❌ `find-component-key.js` - Utility, can recreate if needed

### Obsolete/Experimental Scripts
- ❌ `download-thumbnails.js` - Old method (before base64 embedding)
- ❌ `update-thumbnails.js` - Old method (before base64 embedding)
- ❌ `convert-local-thumbnails.js` - Experimental/duplicate
- ❌ `test-one-thumbnail.js` - Testing script
- ❌ `search-components.js` - Utility, can recreate if needed

### Temporary Documentation
- ❌ `COMPLETE_SETUP.md` - Temporary instructions (superseded by ADDING_NEW_COMPONENTS.md)

### Data Files to Clean
- ❌ `preface-thumbnails-metadata.json` - Temporary metadata file
- ❌ `thumbnail-base64.json` - Old base64 mapping (if exists)

## Cleanup Actions

### 1. Remove Obsolete Scripts
```bash
rm add-concepts-component.js
rm add-concepts-principles.js
rm add-new-components.js
rm download-new-thumbnails.js
rm update-component-key.js
rm find-component-key.js
rm download-thumbnails.js
rm update-thumbnails.js
rm convert-local-thumbnails.js
rm test-one-thumbnail.js
rm search-components.js
```

### 2. Remove Temporary Documentation
```bash
rm COMPLETE_SETUP.md
```

### 3. Remove Temporary Data Files
```bash
rm preface-thumbnails-metadata.json
rm thumbnail-base64.json 2>/dev/null || true
```

### 4. Rebuild Plugin
```bash
npm run build
```

### 5. Test Plugin
- Open in Figma
- Verify all 23 components load
- Verify all thumbnails display
- Test component insertion

## Final File Structure

```
Flow Diagrams/
├── code.ts                          # Main plugin code
├── code.js                          # Built plugin
├── ui.html                          # Plugin UI
├── manifest.json                    # Plugin manifest (no networkAccess)
├── package.json                     # Dependencies
├── tsconfig.json                    # TypeScript config
│
├── scripts/                         # (Optional: move scripts here)
│   ├── convert-all-thumbnails.js
│   ├── convert-preface-thumbnails.js
│   ├── extract-components.js
│   └── verify-thumbnails.js
│
├── docs/                            # (Optional: move docs here)
│   ├── README.md
│   ├── PUBLICATION_DETAILS.md
│   ├── ADDING_NEW_COMPONENTS.md
│   └── RELOAD_PLUGIN.md
│
├── data/
│   ├── components.json              # Component metadata cache
│   └── thumbnails/                  # Source thumbnails
│       ├── *.svg                    # SVG thumbnails
│       └── *.png                    # PNG thumbnails
│
└── UPDATE_SUMMARY.md                # Latest changes
```

## Code Review Findings

### ✅ GOOD: No External Dependencies
- All thumbnails embedded as base64
- No CDN URLs in code
- No external API calls at runtime
- Plugin is fully self-contained

### ✅ GOOD: Proper Error Handling
- Component import has multiple fallback formats
- User feedback for errors
- Graceful degradation

### ✅ GOOD: Documentation
- Clear component descriptions
- Proper categorization
- User-friendly interface

### ⚠️ TO FIX: manifest.json
- ✅ FIXED: Removed `networkAccess` (no longer needed)

### ⚠️ TO CONSIDER: File Organization
- Consider moving scripts to `scripts/` folder
- Consider moving docs to `docs/` folder
- Keep root directory clean

## Verification Checklist

After cleanup:
- [ ] Run `npm run build` successfully
- [ ] Run `node verify-thumbnails.js` - all 23 thumbnails embedded
- [ ] Test plugin in Figma - all components load
- [ ] Test plugin in FigJam - all components load
- [ ] All thumbnails display correctly
- [ ] Component insertion works
- [ ] No console errors

## Git Commit Plan

After cleanup and verification:
```bash
git add manifest.json
git add -u  # Add all deletions
git commit -m "Clean up codebase and remove networkAccess

- Removed networkAccess from manifest.json (thumbnails are base64)
- Deleted temporary one-time-use scripts
- Deleted obsolete download/update scripts
- Kept essential conversion and verification scripts
- Plugin is now fully self-contained with no external dependencies"
git push origin main
```
